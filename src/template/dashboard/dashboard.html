{% extends "base.html" %}

{% block title %}Dashboard - Sistema de RecomendaciÃ³n de Libros{% endblock %}

{% block content %}
<div class="container">
	<div class="row g-3">
		<div class="col-12">
			<div class="card card-ghost p-3">
				<div class="d-flex align-items-center">
					<div class="me-3">
						<i class="bi bi-person-circle fs-1 text-primary"></i>
					</div>
					<div>
						<h4 class="mb-0">Hola, {{ user.name if user and user.name else user.alias if user else 'Usuario' }} ðŸ‘‹</h4>
						<p class="text-muted mb-0">Bienvenido a Libros â€” tus recomendaciones personales te esperan.</p>
					</div>
				</div>
			</div>
		</div>

		<div class="col-lg-8">
			<div class="row g-3">
				<div class="col-6">
					<div class="card p-3">
						<div class="d-flex justify-content-between align-items-center">
							<div>
								<div class="text-muted small">Libros totales</div>
								<div class="fs-4 fw-bold">{{ stats.total_libros if stats and stats.total_libros is not none else 'â€”' }}</div>
							</div>
							<i class="bi bi-book-half fs-2 text-secondary"></i>
						</div>
					</div>
				</div>

				<div class="col-6">
					<div class="card p-3">
						<div class="d-flex justify-content-between align-items-center">
							<div>
								<div class="text-muted small">Recomendaciones</div>
								<div class="fs-4 fw-bold">{{ stats.recomendaciones if stats and stats.recomendaciones is not none else 'â€”' }}</div>
							</div>
							<i class="bi bi-stars fs-2 text-warning"></i>
						</div>
					</div>
				</div>

				<div class="col-12">
					<div class="card p-3">
						<h5>Libros recientes</h5>
						{% if recent_libros and recent_libros|length > 0 %}
							<ul class="list-group list-group-flush">
								{% for libro in recent_libros %}
									<li class="list-group-item d-flex justify-content-between align-items-start">
										<div>
											<div class="fw-semibold">{{ libro.get('titulo') }}</div>
											<div class="text-muted small">{{ libro.get('autor') }} â€¢ {{ libro.get('genero') }}</div>
										</div>
										<div>
											<a class="btn btn-sm btn-outline-primary me-1" href="{{ url_for('libro.obtener_libro_web', libro_id=libro.get('_id') or libro.get('id')) }}">Ver</a>
											<a class="btn btn-sm btn-outline-secondary" href="{{ url_for('libro.crear_libro_web') }}?edit_id={{ libro.get('_id') or libro.get('id') }}">Editar</a>
										</div>
									</li>
								{% endfor %}
							</ul>
						{% else %}
							<p class="text-muted mb-0">AÃºn no hay libros recientes. Puedes <a href="{{ url_for('libro.crear_libro_web') }}">agregar uno</a>.</p>
						{% endif %}
					</div>
				</div>
			</div>
		</div>

		<div class="col-lg-4">
			<div class="card p-3">
				<h6>Acciones rÃ¡pidas</h6>
				<div class="d-grid gap-2">
					<a href="{{ url_for('libro.crear_libro_web') }}" class="btn btn-primary">Agregar nuevo libro</a>
					<a href="{{ url_for('libro.lista_libros_web') }}" class="btn btn-outline-primary">Ver todos los libros</a>
					<a href="{{ url_for('auth.logout') }}" class="btn btn-outline-secondary">Cerrar sesiÃ³n</a>
				</div>
			</div>
			<div class="card p-3 mt-3">
				<h6>Tips</h6>
				<ul class="mb-0">
					<li class="small text-muted">Agrega libros con descripciÃ³n completa para mejores recomendaciones.</li>
					<li class="small text-muted">Califica los libros para mejorar tu perfil.</li>
				</ul>
			</div>
		</div>
	</div>
</div>

{% endblock %}